## Risk/Vuln Name
**Unexpected RCE & Code Attacks**

**Author(s):**
OWASP Agentic Security Initiative Core Team

### Description
Agentic systems often generate or execute code, issue shell commands, or invoke APIs dynamically. Attackers exploit code-generation features or embedded tool access to escalate actions into remote code execution (RCE), local misuse, or exploitation of internal systems. Prompt injection, tool misuse, or unsafe serialization can convert text into unintended executable behavior.

This builds on [LLM01:2025 Prompt Injection](https://genai.owasp.org/llm-top-10/LLM01-prompt-injection) and [LLM02:2025 Insecure Plugin Design](https://genai.owasp.org/llm-top-10/LLM02-insecure-plugin-design), but agentic AI introduces new execution surfaces and inter-agent propagation of executable payloads.

### Common Examples of Risk
1. Prompt injection that leads to execution of attacker-defined code.
2. Code hallucination generating malicious or exploitable constructs.
3. Shell command invocation from reflected prompts.
4. Unsafe function calls, object deserialization, or code evaluation.

### Prevention and Mitigation Strategies
1. Apply strong validation and sanitization on any agent-generated code.
2. Use restricted execution environments or jailed interpreters.
3. Disable dangerous language features (e.g., `eval`, dynamic imports).
4. Require explicit human approval for agent code with elevated privileges.
5. Employ static and dynamic analysis of generated scripts before use.
6. Isolate execution per user/session with resource and permission boundaries.
7. Monitor for prompt injection patterns that influence code generation.

### Example Attack Scenarios
- **Scenario 1: Prompt-to-Shell Injection** – A user prompt includes embedded instructions that are rendered as shell commands by an agent with execution access, resulting in data deletion.
- **Scenario 2: Auto-Generated Exploit** – A planning agent tasked with fixing a web issue hallucinates code that introduces a backdoor due to retrieval from poisoned training data.
- **Scenario 3: Unsafe Deserialization** – A serialized object generated by one agent is passed to another without validation, triggering a vulnerability during rehydration.
- **Scenario 4: Plugin Chain RCE** – A prompt triggers an agent to invoke a plugin chain (e.g., file upload → path resolution → dynamic code execution), allowing attacker-controlled code to run inside the environment.

### Reference Links
1. [LLM01:2025 Prompt Injection](https://genai.owasp.org/llm-top-10/LLM01-prompt-injection)
2. [LLM02:2025 Insecure Plugin Design](https://genai.owasp.org/llm-top-10/LLM02-insecure-plugin-design)